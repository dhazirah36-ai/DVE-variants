<!doctype html>
<html lang="en">
  <head>
    <title>Model Viewer Combined</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link type="text/css" href="./styles.css" rel="stylesheet" />
  </head>

  <body>
    <model-viewer
      id="gear"
      src="final.glb"
      ar
      ar-modes="webxr scene-viewer quick-look"
      camera-controls
      tone-mapping="neutral"
      poster="poster.png"
      shadow-intensity="1"
      auto-rotate
      camera-orbit="-41.01deg 62.16deg 1.14m"
      field-of-view="30deg"
    >

      <!-- HOTSPOTS -->
      <button
        class="Hotspot"
        slot="hotspot-1"
        data-position="-0.098m 0.067m 0.135m"
        data-normal="-0.459m 0.124m 0.879m"
        data-visibility-attribute="visible"
        onmouseenter="showHotspot('hotspot1')"
        onmouseleave="hideHotspot('hotspot1')"
      >
        <div class="HotspotAnnotation" id="hotspot1" style="visibility:hidden">
          Wheels
        </div>
      </button>

      <button
        class="Hotspot"
        slot="hotspot-2"
        data-position="0.175m 0.104m -0.127m"
        data-normal="0.815m -0.350m -0.460m"
        data-visibility-attribute="visible"
        onmouseenter="showHotspot('hotspot2')"
        onmouseleave="hideHotspot('hotspot2')"
      >
        <div class="HotspotAnnotation" id="hotspot2" style="visibility:hidden">
          Speaker
        </div>
      </button>

      <!-- BUILT-IN UI -->
      <div class="progress-bar hide" slot="progress-bar">
        <div class="update-bar"></div>
      </div>

      <button slot="ar-button">View in your space</button>

      <div id="ar-prompt">
        <img src="ar_hand_prompt.png" />
      </div>

      <!-- VARIANT CONTROLS -->
      <div style="position:absolute; bottom:0px; left:200px;">
        <div>
          Variant:
          <button onclick="setVariant('V1')">01</button>
          <button onclick="setVariant('V2')">02</button>
          <button onclick="setVariant('V3')">03</button>
        </div>
      </div>

      <!-- CAMERA POSITION CONTROLS -->
      <div style="position:absolute; bottom:0px; right:0px;">
        <button onclick="setOrbit('-41.42deg 90.33deg 0.8361m')">View 1</button>
        <button onclick="setOrbit('-114.3deg 52.63deg 0.988m')">View 2</button>
        <button onclick="setOrbit('-223.3deg 84.12deg 0.988m')">View 3</button>
      </div>

      <!-- ANIMATION CONTROLS -->
      <div style="position:absolute; bottom:40px; left:200px;">
        <div>
          Animation:
          <button onclick="playAnim('BodyAction')">Body</button>
          <button onclick="playAnim('Front Light C.001Action')">Front Light</button>
          <button onclick="playAnim('Back lightAction')">Back Light</button>
          <button onclick="pauseAnim()">Pause</button>
        </div>
      </div>

    </model-viewer>

    <script type="module"
      src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js">
    </script>

    <script>
      const gear = document.getElementById("gear");

      // HOTSPOTS
      function showHotspot(id) {
        document.getElementById(id).style.visibility = "visible";
      }
      function hideHotspot(id) {
        document.getElementById(id).style.visibility = "hidden";
      }

      // VARIANTS
      function setVariant(name) {
        gear.variantName = name;
      }

      // CAMERA POSITION
      function setOrbit(orbit) {
        gear.cameraOrbit = orbit;
      }

      // ANIMATION
      function playAnim(name) {
        gear.pause();
        gear.currentTime = 0;
        gear.loop = true;
        gear.animationName = name;
        gear.play();
      }

      function pauseAnim() {
        gear.pause();
      }

      // DEBUG (very important)
      gear.addEventListener("load", () => {
        console.log("Available Variants:", gear.availableVariants);
        console.log("Available Animations:", gear.availableAnimations);
      });
    </script>

  </body>
</html>